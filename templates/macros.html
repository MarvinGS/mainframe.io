{% macro sd_image(image_url, title, author) %}
<script type="application/ld+json">
    {
        "@context": "https://schema.org/",
        "@type": "ImageObject",
        "contentUrl": "{{ image_url | safe }}",
        "license": "https://creativecommons.org/licenses/by-sa/4.0/",
        "acquireLicensePage": "https://creativecommons.org/licenses/by-sa/4.0/",
        "creditText": "{{ title }}",
        "creator": {
            "@type": "Person",
            "name": "{{ author }}",
            "url": "https://mainframe.io"
        },
        "copyrightNotice": "{{ author }}"
    }
</script>
{% endmacro %}

{% macro og_image(image_url, width, height, title, author, content_type) %}

<meta property="og:image" content="{{ image_url | safe }}"/>
<meta property="og:image:secure_url" content="{{ image_url | safe }}"/>
<meta property="twitter:image" content="{{ image_url | safe }}"/>

<meta property="og:image:type" content="{{ content_type }}"/>
<meta property="twitter:image:type" content="{{ content_type }}"/>

<meta property="og:image:width" content="{{ width }}"/>
<meta property="twitter:image:width" content="{{ width }}"/>
<meta property="og:image:height" content="{{ height }}"/>
<meta property="twitter:image:height" content="{{ height }}"/>

<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:site" content="{{ author }}"/>
<meta property="twitter:creator" content="{{ author }}"/>

<meta property="og:image:alt" content="{{ title }}"/>
<meta property="twitter:title" content="{{ title }}"/>
{% endmacro %}

{% macro ifs_metadata(image_filename, width, height, title, preview_size=750) %}

{% set scaling = preview_size / height %}
{% set scaled_height = preview_size | round(precision=2) %}
{% set scaled_width = (width * scaling) | round(precision=2) %}
{% set image_url = config.extra.ifs_base_path ~ "/.thumbs/" ~ preview_size ~ "-" ~ image_filename %}

<meta property="og:type" content="article"/>
{{
self::og_image(
image_url=image_url,
width=scaled_width,
height=scaled_height,
author=config.author,
title=title,
content_type="image/jpeg"
)
}}

{{ self::sd_image(image_url=image_url, title=title, author=config.author) }}

{% endmacro %}